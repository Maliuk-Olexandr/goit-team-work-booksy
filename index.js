import{S as T,a as D,A as P,i as d}from"./assets/vendor-DlTilzpZ.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const p of i.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&n(p)}).observe(document,{childList:!0,subtree:!0});function o(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=o(r);fetch(r.href,i)}})();const s={mobMenu:document.querySelector(".mobile-menu"),body:document.body};let g=!1;const E=t=>{if(g)return;g=!0,s.mobMenu.classList.toggle("is-open",t),s.body.classList.toggle("no-scroll",t);const e=o=>{o.target===s.mobMenu&&(g=!1,s.mobMenu.removeEventListener("transitionend",e))};s.mobMenu.addEventListener("transitionend",e)};document.addEventListener("click",t=>{t.target.closest("[data-menu-open]")?E(!0):t.target.closest("[data-menu-close], .mobile-link")&&E(!1)});H();function H(){const t=document.querySelector(".swiper");if(!t){console.warn("Swiper-контейнер не знайдено");return}const e=document.querySelector(".hero-swiper-btn-prev"),o=document.querySelector(".hero-swiper-btn-next");new T(t,{loop:!1,effect:"slide",parallax:!0,navigation:{nextEl:o,prevEl:e},autoplay:{delay:1e4,disableOnInteraction:!0,pauseOnMouseEnter:!0},keyboard:{enabled:!0,onlyInViewport:!0},slidesPerView:1,slidesPerGroup:1,on:{init(r){n(r)},slideChange(r){n(r)}}});function n(r){!e||!o||(e.disabled=r.isBeginning,o.disabled=r.isEnd,e.classList.toggle("disabled",r.isBeginning),o.classList.toggle("disabled",r.isEnd))}[e,o].forEach(r=>{r&&r.addEventListener("click",()=>{r.blur()})}),document.querySelectorAll('.slide-btn[href="#books"]').forEach(r=>{r.addEventListener("click",i=>{i.preventDefault(),document.querySelector("#books")?.scrollIntoView()})})}const $="https://books-backend.p.goit.global/books",N=D.create({baseURL:$});async function h(t=""){try{const{data:e}=await N.get(t);return e}catch(e){throw console.error("Error fetching data:",e.message),e}}async function L(){return(await h("/category-list")).map(e=>e.list_name)}async function v(){return await h("/top-books")}async function M(t){if(!t){const e=new Error("Valid category must be provided.");throw console.error(e),e}return await h(`/category?category=${t}`)}async function S(t){if(!t){const e=new Error("Valid book ID must be provided.");throw console.error(e),e}return await h(`/${t}`)}async function F(){try{const t=await L(),e=await v(),o=await M(t[0]),n=o[0]._id;console.log("\x1B[32mtestAPI() start ------------\x1B[0m"),console.log("\x1B[32m1. getCategoryList():\x1B[0m",t),console.log("\x1B[32m2. getTopBooks():\x1B[0m",e),console.log(`\x1B[32m3. getBooksByCategory('${t[0]}'):\x1B[0m`,o),console.log(`\x1B[32m4. getBookByID("${n}"):`,await S(n)),console.log("\x1B[32mtestAPI() end ------------\x1B[\x1B[0m")}catch(t){console.error("API test failed:",t)}}const O=document.querySelector(".gallery"),u=document.querySelector("#category-select"),c=document.querySelector(".btn-show-more"),U=document.querySelector(".visible-books"),V=document.querySelector(".total-books"),m=document.querySelector(".categories-list");let a=[],l=0;const Q=await L();W(Q);const R=await v();a=R.flatMap(({books:t})=>t);k();function W(t){u.innerHTML='<option selected value="All categories">All categories</option>',m.innerHTML='<li><button class="category-btn active-category" value="All categories">All categories</button></li>',t.forEach(e=>{const o=document.createElement("option");o.value=e,o.textContent=e,u.appendChild(o);const n=document.createElement("li");n.classList.add("category-item");const r=document.createElement("button");r.value=e,r.textContent=e,r.classList.add("category-btn"),n.appendChild(r),m.appendChild(n)})}async function q(t){u.value=t,m.querySelectorAll(".category-btn").forEach(e=>e.classList.toggle("active-category",e.value===t)),t==="All categories"?a=(await v()).flatMap(({books:o})=>o):a=await M(t),k()}u.addEventListener("change",t=>{const e=t.target.value;q(e)});m.addEventListener("click",t=>{if(t.target.tagName!=="BUTTON")return;const e=t.target.value;q(e)});c.addEventListener("click",()=>{l+=4,B(),c.blur()});function k(){c.classList.remove("btn-show-more-hidden"),l=z(),B(),l>=a.length&&c.classList.add("btn-show-more-hidden"),V.textContent=a.length}function B(){const t=a.slice(0,l);O.innerHTML=X(t),U.textContent=Math.min(l,a.length),c.disabled=!1,l>=a.length&&c.classList.add("btn-show-more-hidden")}function z(){return window.innerWidth<768?10:24}window.addEventListener("resize",()=>{k()});function X(t){return t.map(({title:e,author:o,book_image:n,price:r})=>`
    <li class="book-card">
      <img class="book-cover" src="${n}" alt="${e}" width="150" />
      <div class="book-card-info">
        <div class="book-card-descriptions">
          <h3 class="book-card-title">${e.toLowerCase()}</h3>
          <h4 class="book-card-author">${o}</h4>
        </div>
        <p class="book-price">$${r}</p>
      </div>
      <button class="btn-secondary btn-book">Learn more</button>
    </li>
  `).join("")}Object.assign(s,{bookModal_img:document.querySelector(".modal-books_img"),bookModal_title:document.querySelector(".modal-books_title"),bookModal_author:document.querySelector(".modal-books_author"),bookModal_price:document.querySelector(".modal-books_price"),bookModal_details:document.querySelector('[data-ac="details"]'),bookModal_returns:document.querySelector('[data-ac="returns"]'),bookModal_shipping:document.querySelector('[data-ac="shipping"]'),bookModal_data:document.querySelector(".modal-books_data"),bookModal_quantity:document.querySelector("#bookQuantity")});function Y(t){s.bookModal_data.dataset.bookId=t.bookId,s.bookModal_img.src=t.bookPicture,s.bookModal_img.alt=t.bookTitle,s.bookModal_title.textContent=t.bookTitle,s.bookModal_quantity.value=t.bookQuantity,s.bookModal_author.textContent=t.bookAuthor,s.bookModal_price.textContent="$"+t.bookPrice,s.bookModal_details.textContent=t.details,s.bookModal_shipping.textContent=t.shipping,s.bookModal_returns.textContent=t.returns}const _="shopping_cart";function K(t,e){if(!t||e<=0)return console.warn("Wrong parameters, can't add to cart"),!1;const o=x(),n=o[t]||0;return o[t]=Number(n)+Number(e),J(o)}function G(t){if(!t)return 0;const e=x();return Number(e[t])||0}function x(){try{const t=localStorage.getItem(_);return t?JSON.parse(t):{}}catch(t){return console.error("Cart data getting error:",t),{}}}function J(t){try{return localStorage.setItem(_,JSON.stringify(t)),!0}catch(e){return console.error("Cart saving error:",e),!1}}const b={details:"I Will Find You is a gripping thriller by the master of suspense, Harlan Coben. The story follows David Burroughs, a former prisoner wrongfully convicted of murdering his own son. When he discovers a clue suggesting his son might still be alive, David escapes from prison to uncover the truth. Fast-paced, emotional, and full of unexpected twists — this novel will keep you hooked until the very last page.",shipping:"We ship across the United States within 2–5 business days. All orders are processed through USPS or a reliable courier service. Enjoy free standard shipping on orders over $50.",returns:"You can return an item within 14 days of receiving your order, provided it hasn’t been used and is in its original condition. To start a return, please contact our support team — we’ll guide you through the process quickly and hassle-free."},w=new P(document.querySelector(".accordion-container"),{showMultiple:!0,duration:400,collapse:!0});class A{constructor(e){if(!e)throw new Error("Modal Element not found");this.modalElement=e,this.escapeHandler=this.handleEscape.bind(this),this.closeClickHandler=this.handleCloseClick.bind(this)}open(){this.modalElement.classList.add("is-open"),document.body.style.overflow="hidden",document.addEventListener("keydown",this.escapeHandler),this.modalElement.addEventListener("click",this.closeClickHandler)}close(){this.modalElement.classList.remove("is-open"),document.body.style.overflow="",document.removeEventListener("keydown",this.escapeHandler),this.modalElement.removeEventListener("click",this.closeClickHandler)}handleEscape(e){e.key==="Escape"&&this.close()}handleCloseClick(e){const o=this.modalElement.querySelector(".modal_close-btn"),n=o&&o.contains(e.target),r=e.target===this.modalElement;(n||r)&&this.close()}}class Z extends A{constructor(e){if(super(e),this.form=this.modalElement.querySelector("#contactForm"),this.nameInput=this.form.querySelector("#user_name"),this.emailInput=this.form.querySelector("#user_email"),this.messageInput=this.form.querySelector("#user_message"),this.nameErrorContainer=this.form.querySelector(".contact-form-name .validation-error"),this.emailErrorContainer=this.form.querySelector(".contact-form-email .validation-error"),this.messageErrorContainer=this.form.querySelector(".contact-form-message .validation-error"),!this.form)throw new Error("Contact form not found in the modal");this.submitHandler=this.handleSubmit.bind(this),this.handleNameInput=this.clearErrorContainer.bind(this,this.nameInput,this.nameErrorContainer),this.handleEmailInput=this.clearErrorContainer.bind(this,this.emailInput,this.emailErrorContainer),this.handleMessageInput=this.clearErrorContainer.bind(this,this.messageInput,this.messageErrorContainer)}clearErrorContainer(e,o){e.classList.remove("invalid"),o.innerText=""}open(){super.open(),this.form.addEventListener("submit",this.submitHandler),this.nameInput.addEventListener("focus",this.handleNameInput),this.emailInput.addEventListener("focus",this.handleEmailInput),this.messageInput.addEventListener("focus",this.handleMessageInput)}close(){super.close(),this.form.removeEventListener("submit",this.submitHandler),this.nameInput.removeEventListener("focus",this.handleNameInput),this.emailInput.removeEventListener("focus",this.handleEmailInput),this.messageInput.removeEventListener("focus",this.handleMessageInput),this.form.reset()}validate(){const e=[],o={name:"❌ Please enter valid Name",email:{valid:"❌ Please enter valid Email",required:"❌ Email is a required field"},message:"❌ Message can not be empty"};this.nameInput.classList.remove("invalid"),this.emailInput.classList.remove("invalid"),this.messageInput.classList.remove("invalid"),this.nameInput.value.trim()===""&&(e.push(o.name),this.nameInput.classList.add("invalid"),this.nameErrorContainer.innerText=o.name);const n=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return this.emailInput.value.trim()===""?(e.push(o.email.required),this.emailInput.classList.add("invalid"),this.emailErrorContainer.innerText=o.email.required):n.test(this.emailInput.value)||(e.push(o.email.valid),this.emailInput.classList.add("invalid"),this.emailErrorContainer.innerText=o.email.valid),this.messageInput.value.trim()===""&&(e.push(o.message),this.messageInput.classList.add("invalid"),this.messageErrorContainer.innerText=o.message),e}async handleSubmit(e){e.preventDefault();const o=new FormData(this.form),n=Object.fromEntries(o.entries());if(!(this.validate().length>0))try{await this.submitForm(n),d.show({position:"center",theme:"light",message:"❤︎ Your registration has been submitted."}),this.close()}catch(i){console.error("Form submission error:",i),d.show({position:"center",theme:"light",message:"✖ 'There was an error submitting your registration. Please try again.'"})}}async submitForm(e){console.log("Submitting form data:",e)}}class j extends A{constructor(e){super(e),this.eventHandler=this.handleEvents.bind(this)}async open(e){try{const o=await S(e),n=this.prepareData(o);Y(n),w&&w.closeAll(),super.open(),this.form=this.modalElement.querySelector("#bookModalActionForm"),this.form&&(this.form.addEventListener("click",this.eventHandler),this.form.addEventListener("submit",this.eventHandler))}catch(o){console.error(`Error loading book with ID ${e}:`,o),d.show({position:"center",theme:"light",message:"✖ 'Sorry, couldn't load the book details. Please try again later.'"})}}close(){super.close(),this.form&&(this.form.removeEventListener("click",this.eventHandler),this.form.removeEventListener("submit",this.eventHandler))}prepareData(e){return{bookId:e._id,bookPicture:e.book_image,bookTitle:e.title,bookAuthor:e.author,bookPrice:e.price,bookQuantity:1,details:e.details||b.details,shipping:e.shipping||b.shipping,returns:e.returns||b.returns}}handleEvents(e){e.preventDefault();const o=e.target;switch(o.dataset.action){case"decrease":this.updateQuantity(-1);break;case"increase":this.updateQuantity(1);break;case"add-to-cart":this.handleAddToCart(o);break;case"buy-now":this.handleBuyNow();break}e.type==="submit"&&this.handleBuyNow()}updateQuantity(e){const o=this.form.querySelector(".quantity-input"),r=parseInt(o.value)+e;r>=1&&(o.value=r)}handleAddToCart(e){const n=e.closest("[data-book-id]").dataset.bookId,r=parseInt(this.form.querySelector(".quantity-input").value);d.show({iconUrl:"/img/shopping_basket.svg",iconColor:"white",balloon:!1,theme:"light",progressBar:!0,message:`Book (qty: ${r}) added`,transitionIn:"flipInX",transitionInMobile:"flipInX",target:".modal-books_message-container",targetFirst:!1,timeout:3e3,animateInside:!0}),console.log(`Book with ID '${n}' (qty: ${r}) added to Cart.`),console.log(`Total ID '${n}' in Cart: ${G(n)}`),K(n,r)}handleBuyNow(){console.log('"Buy Now" clicked.'),d.show({iconUrl:"/img/shopping_basket.svg",iconColor:"white",position:"center",balloon:!1,theme:"light",progressBar:!0,message:"Thanks for buying!",transitionIn:"flipInX",transitionInMobile:"flipInX",targetFirst:!1,timeout:5e3,animateInside:!0}),this.close()}}const C=document.querySelector(".modal-contacts"),I=document.querySelector(".modal-books");let f,y;C&&(f=new Z(C));I&&(y=new j(I));function ee(t="Children’s Story Hour"){f?(document.querySelector("#modalDesc").textContent=t,f.open()):console.error("Contact modal is not initialized.")}function te(t="660df41ba957e5c1ae0f519e"){y?y.open(t):console.error("Books modal is not initialized.")}window.openBooksModal=te;window.openContactsModal=ee;F();
//# sourceMappingURL=index.js.map
